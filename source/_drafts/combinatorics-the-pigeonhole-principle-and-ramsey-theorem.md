---
title: "[Combinatorics] The Pigeonhole Principle & Ramsey Theorem"
date: 2022-03-29 18:48:00
tags:
  - combinatorics
---

# The Pigeonhole Principle



## The Simple Pigeonhole Principle

### Definition

#### Content

如果把`n+1个物体`放入`n个盒子`中，那么`至少有一个盒子`将`包含两个或更多的物体`。



> 如果将`n个物体`放入`n个盒子`中，且`没有任何一个盒子是空的`。则`每个盒子恰好包含1个物体`

> 如果将`n个物体`放入`n个盒子`中，且`没有盒子被放入多于1个的物体`。则`则每个盒子恰好包含1个物体`

>如果`集合X`和`集合Y`是`有限集合`，并令$f: X \rightarrow Y$是`一个从X到Y的映射`：
>
>- 如果$|X| > |Y|$，那么就不是`双射 (即一一对应)`
>
>- 如果$|X| = |Y|$ 且 该映射是`满射`，则该映射是`双射`
>
>- 如果$|X| < |Y|$ 且 该映射是`双射`，则该映射是`满射`



#### Proof

##### Proof 1

先在`n个盒子`里`放入1个物体`，则`剩下的1个物体` `所处的盒子`将`包含2个或更多的物体`

##### Proof 2

对于`显而易见的结论`，可以采用`反证法`。

我们`假设` `没有任何盒子将包含两个或更多物体`，也就是说`每个盒子最多包含1个物体`。

所以，`n个盒子`应当`最多包含n个物体`。而$n \lt n + 1$，这与`我们的假设产生矛盾`。

Q.E.D



### Application

#### Application 1

##### Content

给定m个整数$a_1,a_2,\cdots,a_m$，存在满足$0 \le k \le l \le m$的`整数k`和`整数l`，使得$a_{k+1} + a_{k+2} + \cdots + a_l$能被`整数m`整除。

##### Proof

考虑`m个和`：
$$
a_1, a_1+a_2, a_1+a_2+a_3,\cdots,a_1+a_2+a_3+\cdots+a_m
$$
如果`这m个和之中`存在`一个和 可被m整除`，则结论成立。

因此，我们可以假设`这m个和`中`每一个除以m的余数`，`余数`等于$1,2,\cdots,m-1$中的一个数。

由于有`m个和`，而有`m-1个余数`，所以必定有`2个和 他们除以m的余数相同`。

因此，存在`整数k`和`整数l`，使得$a_1+a_2+\cdots+a_k$和$a_1+a_2+\cdots+a_l$ `除以m有相同的余数r` 。即
$$
\begin{aligned}
a_1 + a_2 + \cdots + a_k = bm + r \\
a_1 + a_2 + \cdots + a_l = cm + r \\
\end{aligned}
$$
将`两式相减`得
$$
a_{k+1} + \cdots + a_l = (b-c)m
$$
因此，存在满足条件的`整数k`和`整数l`，使得结论成立。

> 这里的关键点在于，如果我们将`前缀和k`和`前缀和l`分别表示成`前缀和 = p * m + r的形式`。由于$r_1 = r_2 = r$，
>
> 所以我们只需要将`两个前缀和相减`即可得到`一个能被m整除的数: `$(p_1 - p_2)m$
>
> 而且，当我们对`前缀和进行相减`时，并不会`破坏所得序列的连续性`！

Q.E.D

#### Application 2

##### Content

一位`国际象棋大师`有`11周的时间`来备战一场锦标赛。

- 他决定`每天至少下一盘棋`。

- 但为了不使自己过于疲劳，他还决定`每周不能下超过12盘棋`

证明：存在`连续的若干天`，使得这位大师`恰好下了21盘棋`



##### Proof

我们设$a_i$表示`前i天所下的棋数的总和`。则有序列
$$
a_i, a_2, \cdots, a_{77}
$$
因为`每天至少要下一盘棋`，`该序列`是`严格递增的` 且 $a_1 \ge 1$。

因为`每周不能下超过12盘棋`，则$a_{77} \le 12 \times 11 = 132$

故$$ 1 \le a_1 \le a_2 \le \cdots \le a_{77} \le 132 $$

故$22 \le a_1 + 21 \le a_2 + 21 \le \cdots \le a_{77} +21 \le 153$

构造新序列
$$
a_1,a_2,\cdots,a_{77},\textcolor{blue}{a_1 + 21, a_2 + 21, \cdots, a_{77}+21}
$$
则`这2 × 77 = 154个数字`$\in \{1, 2, \cdots, 153\}$这个`含有153个元素的集合`。

因此，`这154个数字`中`有两个数字是相等的`。

> 题干中的`21盘棋`并非随意选取，`154 > 11 * 21 = 153`，因而`21盘棋`正好是一个`阈值`



但由于$\{a_1, a_2, \cdots, a_{77}\}$中`没有相同的数字`，而$\{a_1 + 21 , a_2 + 21, \cdots, a_{77} + 21\}$中也`没有相同的数字`。

故存在`i`和`j`，使得$a_i = a_j + 21$：大师在`第j+1天`，`第j+2天`，...，`第i天`总共下了`21盘棋`

Q.E.D



#### Application 3

##### Content

从整数$1,2,\cdots,200$中选取101个整数，证明`其中的一个整数`可被`另一个整数`所整除。

##### Proof

根据`任何整数都可以写成`$2^k \times a \qquad (k \ge 0 \quad and \quad a \% 2=1)$的形式

对于`1和200之间的任何整数`，`a`是`100个数：1,3,5，...，199的总共100个数`中的一个数。

因为`总共选取101个整数`，则必定有`两个选取的整数`使得`存在相同的a`，即$a_1 = a_2 = a$

将`所选取的这2个数`表示为：$2^{k_1} \times a$和$2^{k_2} \times a$

因此，`其中一个数`必定是`另一个整数`的`2的倍数`。

Q.E.D



#### Application 4: Chinese Remainder Theorem

##### Content

设`m`和`n`是`互素的正整数`，并设`a和b`为`整数`，其中$0 \le a \le m - 1$以及$\textcolor{red}{0 \le b \le n -1}$

则，存在`正整数x`,使得`x除以m的余数为a`，并且`x除以n的余数为b`

##### Proof

将这个`正整数x`表示为如下形式：
$$
\begin{aligned}
\textcolor{red}{x = p \times m + a}\\
x = q \times n + b
\end{aligned}
$$

---

考虑这`n个整数`$\textcolor{red}{a, m + a, 2m + a, \cdots, (n-1)m + a}$

> 这里我们让`p`取`b的所有可能取值`：$0 \le b \le n-1$

这两个数`为`im + a`和`jm + a`且$\textcolor{blue}{0 \le i \lt j \le n-1}$

故存在`两个整数`$q_i$和$q_j$
$$
\begin{aligned}
im + a = q_i \times n + r\\
jm + a = q_j \times n + r
\end{aligned}
$$
`两式相减`得
$$
(j-i)m = (q_j - q_i)n
$$
故`n是(j-i)m`的因子。又因为`m和n互素`，所以`只能` `n是j-i的因子`。

然而，$\textcolor{blue}{0 \le i \lt j \le n-1 \Rightarrow 0 \lt j - i \le n - 1}$，这告诉我们，`n不可能是j-i的因子`。故`与假设产生矛盾`。

所以，`这n个数中的每一个数` `除以n都有不同的余数`：也就是说，`n个数: `$\textcolor{red}{a, 1, 2,..., n - 1}$ `中的每一个`都要作为余数而出现。

> 注：在这个`反证法`中，我们不但证明了$a, m+a, 2m+a, \cdots, (n-1)m + a$除以`n` `所产生的余数都不相同`。
>
> 而且，还得出了`这n个余数就是`$a, 1, 2, \cdots, n-1$ 而 `b`就包含在这些余数中！

---

若设`整数p`满足$0 \le p \le n-1 $，使得$ \textcolor{green}{x = p \times m + a}$ `除以n的余数`为`b`。

则，对于某个`整数q`，有
$$
\textcolor{green}{x =  q \times n + b}
$$
Q.E.D



#### Application 5

##### Content

`有理数a/b`最终可以表示成`十进制的循环小数`

## The Enhanced Pigeonhole Principle

### Definiton

#### Content

设$q_1, q_2, \cdots, q_n$是正整数。如果将 $q_1 + q_2 + \cdots + q_n - n + 1$个`物体`放入`n个盒子`。

那么`或者第一个盒子至少含` $q_1$个物体，`或者第二个盒子至少含`$q_2$个物体，...，`或者第n个盒子至少含`$q_n$个物体



> 通过令$q_i = 2$，可以得到`The Simple Pigeonhole Principle`

#### Proof

##### Proof 1

先把$q_i$个`物体`放入`第i个盒子`。然后`从所有的盒子`中`取走n-1个物体`。

即使是对于`从每个盒子中取走1个物体`，那么`仍然有1个盒子没有被取走物体`。

Q.E.D

##### Proof 2

使用`反证法`：`假设第i个盒子所含物体少于i个`。

则`总共需要的物体数量 <= `$(q_1 - 1) + (q_2 - 1) + \cdots + (q_i - 1) = (q_1 + q_2 + \cdots + q_i) + n$ 

与题干矛盾。

Q.E.D

### Application

#### Application 1

##### Content 

设n和r都是正整数。如果把`n(r-1)+1个物体`分配到`n个盒子`，那么`至少有1个盒子含有r个或更多的物体`

##### Proof

###### Proof 1

我们仍然可以采用`组合计数`的方法来证明。

首先，将`r-1个物体`分别放入`n个盒子`，这样，`n个盒子的每个盒子均含有r-1个物体`。

接下来，我们考虑将`剩下的1个物体`随便地放入`n个盒子中的1个盒子`。

则`该盒子含有r个物体`

Q.E.D

###### Proof 2

我们可以采用`平均原理`来证明。

如果`至少有1个盒子含有r个或更多的物体`，则意味着`n个盒子中的每个盒子平均包含的物体数 >= r-1个物体`

> 可以想象，如果`所有的n个盒子`都`恰好含r-1个物体`，则`平均数 = r-1`。
>
> 如果`平均数 > r-1`则说明`至少有1个盒子包含超过r-1个物体，这个盒子拉高了平均值`，即等价地说：`这个盒子至少包含r个物体`


$$
\begin{aligned}
\frac{n(r-1)+1}{n} &= (r-1) + \frac{1}{n} \\

&\gt r - 1

\end{aligned}
$$

#### Application 2

##### Content

证明每个由$n^2+1$个实数构成的序列$a_1,a_2,\cdots,a_{n^2+1}$  `或者含有长度为n+1的递增子序列`，`或者含有长度为n+1的递减子序列`。

> 单调性不是严格的

##### Proof

###### Proof 1

`假设：不存在长度为n+1的递增子序列`。`证明：必然存在长度为n+1的递减子序列`

对于$k = 1,2,\cdots,n^2+1$，设 $m_k$为`从`$a_k$`开始的最长的递增子序列的长度`，则$\textcolor{blue}{1 \le m_k \le n}$

故：$\textcolor{blue}{m_1, m_2, \cdots, m_{n^2+1}}$是$\textcolor{blue}{1,2,\cdots,n}$之间的$n^2 +1$个整数

> 如果存在某个$m_k \gt n$，则很显然结论成立。
>
> 故此处限定$m_k \in \{1,2,\cdots, n\}$

根据`鸽巢原理`知，这$n^2+1$个整数中有$n+1$个整数是`相等的`

> 这是因为我们`假设：不存在长度为n+1的递增子序列`
>
> $n \times n + 1 = n^2 + 1 $

令$m_{k_1} = m_{k_2} = \cdots = m_{k_{n+1}} , \quad (1 \le k_1 \le k_2 \cdots \le n^2 +1 )$

假设对某个$i = 1,2,\cdots, n$，存在$a_{k_i} \lt a_{k_{i+1}}$。

则由于$k_i < k_{i+1}$，我们可以做成一个从$a_{k_{i+1}}$开始的最长的递增子序列，并将$a_{k_i}$放在前面而得到`一个从$a_{k_{i}}$开始的递增子序列`。

由于这意味着$m_{k_i} \gt m_{k_{i+1}}$，因此我们得出$a_{k_{i}} \ge a_{k_{i+1}}$的结论。



而这对每个$i = 1,2,\cdots, n$均成立，则我们有$a_{k_{1}} \ge a_{k_{2}} \ge \cdots \ge a_{k_{n+1}}$

从而得出，$a_{k_{1}}, a_{k_{2}},\cdots, a_{k_n+1}$是`一个长度为k+1的递减子序列`



#### Application 3

##### Content

有两个`碟子`，其中一个比另一个小，这`两个碟子`分别被`分成200个均等的扇形`。

- 对`大碟子`：任选`100个扇形`着色为`红色`，任选`100个扇形`着色为`蓝色`
- 对`小碟子`：`200个扇形`任意地`着色`为`红色`或`蓝色`

然后，将`小碟子`放在`大碟子`上，使得`它们的中心重叠`。证明：`存在某种对齐方案`使得`两个碟子上相同颜色重合的扇形数目` `至少为100个`

> 也就是说，这两个碟子 其实就是 同心圆



##### Proof

利用`平均原理`

首先，将`大碟子` `固定住`。

则`小碟子上的每个扇形都存在200个可能位置`，且`小碟子上的每一个扇形` `都恰好在100个位置上与大碟子上的对应扇形颜色一致`

> 因为`大碟子的涂色 = 100个红色 + 100个蓝色`。`对于小碟子上的每一个扇形`，`这个扇形`与`大碟子的200个颜色中的100个颜色相一致`

故，在`考虑所有的200个位置`时，`颜色重合总数 = 小碟子上的扇形数 × 100 = 20000`。

> 该乘法运算独立了`小碟子上的某个扇形`和`大碟子上的某个位置`，即形成`有序对（小碟子上的某个扇形，大碟子上的某个位置）`是`满足颜色一致的`
>
> 因而，使用`笛卡尔乘积`可以得出，`这样的有序对数量 = 200 × 100 = 20000`

因此，`每一个位置上的平均颜色重合数 = 20000 / 200 = 100`。

> 我们有`20000个 有序对（小碟子上的某个扇形，大碟子上的某个位置）`，则`分解该有序对`得到：
>
> 20000 / 200 = 100 个 `小碟子上的某个扇形` 将`满足颜色一致的条件`

从而，`必然存在某个位置`使得`满足颜色匹配数至少为100`

Q.E.D



## Ramsey Theorem

### Introduction

#### Background

在`6个人（或更多人）中`，`或者有3个人，他们中的两个人互相认识`，`或者有3个人，他们中的两个人互相不认识`。

#### Proof

![image-20220329161846149](https://s2.loli.net/2023/01/22/viNfBruVXME6PzY.png)

将`原问题`抽象为$K_6 \rightarrow K_3, K_3$

> $K_n$表示的是`n阶完全图`。我们对`边`进行`着色`：令`红色表示认识`，`蓝色表示不认识`。
>
> 因而，$K_6 \rightarrow K_3, K_3$含义为：无论如何使用`红色`和`蓝色`对$K_6$进行`着色`，总存在`1个红`$K_3$或者`1个蓝`$K_3$

首先，假设$K_6$已经被`任意着色`，则取$K_6$中的`任意一点p`，那么`该点`连接了`5条边`。

则根据`鸽巢原理`，`该点` `或者连接至少3个红边`，`或者连接至少3个蓝边`。

不妨假设，`该点至少连接3个红边`，我们假设`这3条红边`由`点p`和`点a，点b，点c`所确定。

考虑`将a，b，c两两相连的边`：

- 若`这些边都是蓝边`，则`点a，点b，点c`确定了一个`蓝`$K_3$
- 若`这些边有一条是红边（假设为连接a和b的边）`，则`点p，点a，点b`确定了一个`红`$K_3$



### Content

如果$m \ge 2$且$n \ge 2$是两个整数，则存在`正整数p`，使得$K_p \rightarrow K_m, K_n$

> `Ramsey Number`：$r(m, n)$是使得$K_p \rightarrow K_m, K_n$成立的`最小的整数p`。
>
> $r(m, n) = r(n, m)$

### Proof

证明$r(2,n)= n$，则我们需要证明`2个不等式`

- $r(2,n) \le n$：如果将$K_n$的`所有边`都着色为`红色`或`蓝色`。那么`或者得到`$红K_2$，`或者得到`蓝$K_n$

  > 换句话说：只要我们给$K_n$着色`1条红边`，则可得到红$K_2$。但如果我们不给$K_n$着色`红边`，
  >
  > 也就是我们必须给$K_n$全部着色为`蓝边`，这样的话，我们就会得到蓝$K_n$

- $r(2,n) \gt n-1$：我们可以选择给$K_{n-1}$的`所有边`都着色为`蓝色`，则我们`既得不到红`$K_2$，`也得不到蓝`$K_n$

  > 实际上，无论如何着色都不可能得到`蓝`$K_n$：因为我们`只有n-1个人`，肯定不存在`n个人相互认识`

Q.E.D

> $r(2, n)$和$r(m, 2)$称为`平凡Ramsey数`

---

接下来，我们考虑更一般的情况。

使用`双重归纳法`$\textcolor{blue}{证明r(m,n)的存在性}$。

已证得$r(2, n) = n$和$r(m, 2) = m$。

现在`假设`$m \ge 3$且$n \ge 3$。取`归纳假设`为`r(m-1, n) 和 r(m, n-1) 存在`

设$\textcolor{blue}{p = r(m-1, n) + r(m, n -1)}$，证明$K_p \rightarrow K_m, K_n$

假设$K_p$已被`任意着色`，我们`任取`$K_p$中的`某点x`，并设$R_x$是`通过红边与点x相连的 点的集合`，$B_x$是`通过蓝边与点x相连的 点的集合`。

则
$$
|R_x| + |B_x| = p - 1 = r(m-1, n) + r(m, n -1) - 1
$$
这意味着：

1. $|R_x| \ge r(m-1, n)$ 或
2. $|B_x| \ge r(m, n - 1)$

> 否则，将意味着 $|R_x| + |B_x| \le \textcolor{red}{r(m-1,n) - 1} + \textcolor{blue}{r(m, n-1) - 1} = p - 2$，产生矛盾。

---

当情况1成立时：即$|R_x| \ge r(m-1, n)$成立。

设$q = |R_x| \ge r(m-1, n)$，则考虑`由`$R_x$的点组成的$K_q$，则：

1. 或者$K_q$中有`m-1个点`（即$K_p$中的点）其所有边被着色为`红色`。（即存在红$K_{m-1}$）

   > 对于这种情况，我们可以将`点x`加入$红K_{m-1}$后得到一个$红K_m$，然后`完成Ramsey Theorem的证明`

2. 或者$K_q$中有`n个点`其所有边被着色为`蓝色`。（即存在蓝$K_n$）

   > 对于这种情况，我们可以`立即完成Ramsey Theorm的证明`：因为我们`已经拥有了一个蓝`$K_n$



> `当情况2成立`时，与`情况1成立时`是`对称的`

当情况2成立时：即$|B_x| \ge r(m, n -1)$成立

设$q = |B_x| \ge r(m, n-1)$，则考虑$由B_x的点组成的K_q$，则：

1. 或者$K_q$中有`m个点`其所有边被着色为`红色`（即存在$红K_m$）

   > 对于这种情况，我们可以`立即完成Ramsey Theorem`的证明：因为我们`已经拥有了一个红`$K_m$

2. 或者$K_q$中有`n-1个点`其所有边被着色为`蓝色`（即存在$蓝K_{n-1}$）

   > 对于这种情况，我们可以将`点x`加入$蓝K_{n-1}$后得到一个$蓝K_n$，然后`完成Ramsey Theorem的证明`

---

综上，对于所有的整数$m, n \ge 2$，数$r(m, n)$存在

Q.E.D



> 		上述定理不但`确定了Ramsey Number的存在性`，而且给出了`上界`
> 	$$
> 	\begin{aligned}
> 	r(m,n) &\le r(m - 1, n) + r(m, n - 1) ,\quad(m,n \ge 3)\\
> 	&=\textcolor{blue}{f(m,n) = \binom{m+n-2}{m-1},\quad(m,n\ge2)} \qquad\text{(Define f(m,n))}\\
> 	&=\binom{m+n-2}{m-1} = \binom{m+n-3}{m-1} + \binom{m+n-3}{m-2} \qquad\text{(Pascal's Formula)}\\ 
> 	&=\binom{m+n-2}{n - 1} = \binom{m+n-3}{n - 1} + \binom{m+n-3}{n - 2}\\
> 	&=\textcolor{blue}{f(m - 1, n)+ f(m, n - 1),\quad(m,n\ge2)} 
> 	\end{aligned}
> 	$$
> 	原因在于：我们所设的$f(m,n)$与$r(m,n)$具有`相同的递归表达式`和`相同的初始条件`



### Generalization

#### Generalization 1

可以将`Ramsey Theorem`  拓展到`任意多种颜色`。即`存在最小整数p`，使得
$$
K_p \rightarrow K_{n_1}, K_{n_2}, K_{n_3}, \quad (n_1, n_2, n_3 \ge 2)
$$
我们称这个`最小整数p`为Ramsey Numeer：$r(n_1, n_2, n_3)$

#### Generalization 2

前面所说的`Ramsey Theorem`针对的是`点对（即两个元素的子集）`。现在我们可以拓展到`t个元素的子集`。

则$K_n^t, \quad t \ge 1$是`n元素集合中所有t元素子集 的集合`。

即：给定$整数p \ge 2$，$整数q_1, q_2, \cdots, q_k \ge t$ ，存在一个`整数p`，使得：
$$
K_p^t \rightarrow K_{q_1}^t, K_{q_2}^t, \cdots, K_{q_k}^t
$$
成立。

> 即存在`整数p`，使得如果给`p元素集合中的每一个t元素子集`着色`k种颜色中的一种`，则：$或者存在q_1个元素，这些元素的所有t子集 都被涂色为c_1$，
>
> $或者存在q_2个元素，这些元素的所有t子集都被涂色为c_2$，...，$或者存在q_k个元素，这些元素的所有t子集都被涂色为c_k$
>
> 而这个`整数p`即为`Ramsey Numebr`$r_t(q_1, q_2,\cdots, q_k)$

> 当$t = 1$时，`Ramsey Theorem` = `The Enhanced Pigeonhole Principle`
>
> 当$t = 2$时，`Ramsey Theorem` = `Ramsey Theorem: r(m, n)`
