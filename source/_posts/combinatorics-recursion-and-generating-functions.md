---
title: Combinatorics - Recursion and Generating Functions
tags: []
id: '37044'
categories:
  - - uncategorized
date: 2022-04-07 18:38:33
---

# Recursion And Generate

## Sequence

### Arithmetic Sequence & Geometric Sequence

### Fibonacci Sequence

#### Theory

##### Theory 1

* * *

##### Theory 2

##### Theory 3

##### Theory 4

在`帕斯卡三角形`的`从左下到右上的对角线上的二项式系数的和`就是`斐波那契数`：

* * *

故，只需证明g\_n满足`斐波那契关系`。

Q.E.D

#### Example

##### Example 1

##### Example 2

求使用`多米诺骨牌` `完美覆盖` `2 × n棋盘`的`方法数`h\_n

* * *

尝试将`原问题`的转化为`子问题`。

可以将`所有的放置方案` `划分`为两种`类型`

1.  第一个2 × 1的棋盘放置1个`竖直多米诺骨牌`：该种类型的方案数为h\_{n-1}
2.  第一个2 × 2的棋盘放置2个`水平多米诺骨牌`：该种类型的方案数为h\_{n-2}

综上，h\_n = h\_{n-1} + h\_{n-2},\\quad (n \\ge 2)

> 我们定义h\_0 = 1，计算求得h\_1 = 1

### General Generating Functions

#### Definition

> `生成函数`是无限可微分函数的`泰勒级数 (Taylor)` `(幂级数展开式)`

若h\_0,h\_1,\\cdots,h\_n,\\cdots是`无穷数列`，则它的`生成函数 (Generating Function)`定义为`无穷级数`g(x) = h\_0 + h\_1x + h\_2x^2 + \\cdots + h\_nx^n + \\cdots

#### Example

##### Example 1

##### Example 2

* * *

##### Example 3

> 由于 `这k个因子中的每一个项的系数均为1`，所以x\_n`的系数` = `方程的非负整数解的个数`

##### Example 4

确定`苹果`，`香蕉`，`橘子`和`梨`的`n组合的个数`，且要求苹果的个数是偶数，香蕉的个数是奇数，橘子的个数在0和4之间，至少要有1个梨。

* * *

> 当e\_i前面带有`系数`时，我们可以很容易地将`系数`变为`1`
> 
> > 只需要简单的使用`变量替换`即可，则e\_i \\rightarrow e\_i'

##### Example 5

##### Example 6

* * *

> `多项式`g\_n(x)`的次数 =` 0+1+2+\\cdots+(n-1) = \\frac{n(n-1)}{2}

对于所有的p = 0,1,\\cdots,n(n-1)/2，有g(x)中中x^p的系数 = h(n,p)(x)

Q.E.D

### Exponential Generating Functions

#### Definition

#### Example

##### Example 1

##### Example 2

##### Example 3

* * *

Q.E.D

##### Example 4

设h\_n表示`由数字1,2,3构造的n位数的个数`，其中在`这个n位数`中：1的个数为偶数，2的个数至少为3，3的个数至多为4。

确定数列h\_0, h\_1, \\cdots, h\_n, \\cdots的`指数生成函数`

* * *

##### Example 5

用`红色`，`白色`和`蓝色`三种颜色给`1 × n的棋盘`进行着色，求`被着色成红色的方格数是偶数的方案数`。

* * *

*   Generating Functions

*   Recursion

考虑`1 × n的棋盘`，我们可以`划分`为`两个部分`：`第1格`和`剩下的所有格子`：

1.  如果`第一格涂非红色`
    
    1.  第一格涂白色：h\_{n-1}
    2.  第一格涂蓝色：h\_{n-1}
2.  如果`第一格涂红色`：则由于`奇偶性`可知，`剩下的格子中红色的方格数是奇数 = 所有方案 - 红色方格是偶数的方案`。3^{n-1} - h\_{n-1}
    

综上，h\_n = (2h\_{n-1}) + (3^{n-1} - h\_{n-1}) = h\_{n-1} + 3^{n-1} \\implies h\_n = \\frac{3^n + 1}{2}

##### Example 6

确定满足下列条件的`n位数的个数`：每个数字都是`奇数`，`数字1`和`数字3`出现偶数次。

* * *

##### Example 7

确定使用`红色`，`白色`和`蓝色`三种颜色给`1 × n棋盘`的着色中：红格数量为`偶数`，蓝格`至少有一个` 的着色方法数。

* * *

### Fractional Generating Functions

#### Definition

`分式生成函数`可以用于求解`k阶常系数线性齐次递推关系`：

p(x)是`次数小于k的多项式`，q(x)是`常数项等于1的k阶多项式`

#### Theory

##### Theory 1

设h\_0,h\_1,h\_2,\\cdots,h\_n是满足h\_n + c\_1h\_{n-1} + \\cdots + c\_kh\_{n-k} = 0,\\quad c\_k \\ne 0 \\quad(n \\ge k)的`k阶常系数齐次递推关系的数列`，则它的`生成函数` g(x)是

形如下列形式的函数g(x) = \\frac{p(x)}{q(x)}，其中p(x)是`次数小于k的多项式`，q(x)是`常数项不等有0的k次多项式`。

反之，给定这样的`多项式`p(x)和q(x)，则存在`序列`h\_0,h\_1,h\_2,\\cdots, 满足上述给出的类型的`k阶常系数齐次递推关系`，且`生成函数`为g(x) = \\frac{p(x)}{q(x)}

* * *

#### Example

##### Example 1

求解h\_n + h\_{n-1} - 16h\_{n-2} + 20h\_{n-3} = 0 \\quad(n \\ge 3), h\_0 = 0, h\_1 = 1, h\_2 = -1

* * *

### Solve Recursive Relations

#### Solve Linear Homogeneous Recursive Relations

##### Definition

若h\_0,h\_1,\\cdots,h\_n,\\cdots是一个`数列`。我们称该`数列`满足`k阶线性递推关系`是指：存在`量`a\_1,a\_2,\\cdots,a\_k \\quad(a\_k \\ne 0)和`量`b\_n，使得

\\textcolor{blue}{h\_n = a\_1h\_{n-1} + a\_2h\_{n-2} + \\cdots + a\_kh\_{n-k} + b\_n \\quad(a\_k \\ne 0, n \\ge k)}

> a\_1,a\_2,\\cdots a\_k ,b\_n有可能是`常数`，也有可能依赖于n

> 如果a\_1,a\_2,\\cdots, a\_k是`常数`，则我们称这个`线性递推关系`是`常系数的 (Constant Coefficient)`
> 
> 如果b\_n = 0，则我们称这个`线性递推关系` 是`齐次的 (Homogenous)`

`初始值`指的是h\_0,h\_1,\\cdots,h\_{k-1}的值，一旦初始值被指定后，`递推关系`就`唯一确定`，而`递推关系`将从`n=k`开始`生效`。

##### Theory

###### Theory 1

设`q`是一个`非零的数`，则h\_n = q^n是下面`常系数线性齐次递推关系`h\_n - a\_1h\_{n-1} - a\_2h\_{n-2} - \\cdots - a\_kh\_{n-k} = 0 \\quad(a\_k \\ne 0, n \\ge k)的`解` `当且仅当` `q`是下面`多项式方程`x^k - a\_1x^{k-1} - a\_2x^{k-2} - \\cdots - a\_k = 0的`根`。

如果`多项式方程`有`k个不同的根`q\_1, q\_2, \\cdots, q\_k则 h\_n = c\_1q\_1^n + c\_2q\_2^n + \\cdots + c\_kq\_k^n是`常系数线性齐次递推关系`的`通解`

> 注意：h\_n是通解的前提是，这k个根是`不同的`，也就是这k个根中不能有`重根`！

* * *

###### Theory 2

设q\_1, q\_2, \\cdots, q\_t是`常系数线性齐次递推关系`h\_n = a\_1h\_{n-1} + a\_2h\_{n-2} + \\cdots + a\_kh\_{n-k},\\quad (n \\ge k)`的特征方程`的`互不相同的根`。

如果q\_i是`特征方程的`s\_i`重根`，则这个`递推关系的通解`中`对应于`q\_i`的部分`是\\textcolor{blue}{H\_n^{(i)} = c\_1q\_i^n + c\_2nq\_i^n + \\cdots + c\_{s\_i}n^{s\_i - 1}q\_i^n = (c\_1 + c\_2n + c\_3n^2 + \\cdots + c\_{s\_i}n^{s\_i - 1}) q\_i^n}

这个`递推关系的通解`是h\_n = H\_n^{(1)} + H\_n^{(2)} + \\cdots + H\_n^{(t)}

> 当求解递推关系遇到`重根`时，可以使用该方法`构造` `剩余的解`

##### Example

###### Example 1

二阶常系数线性齐次微分方程

###### Example 2

已知`初始值`h\_0 = 1, h\_1 = 2, h\_2 = 0，求解`递推关系`h\_n = 2h\_{n-1} + h\_{n-2} - 2h\_{n-3} \\quad(n \\ge 3)

* * *

###### Example 3

只由三个`字母a, b, c`组成的`长度为n的一些单词`在`通信信道`上传输，满足条件：传输中不得有`两个连续的a`出现在`任一单词`。

确定`通信信道`中`允许传输的单词个数`

* * *

> Method 1: Solve the recursive equation

设h\_n表示`允许传输的长度为n的单词个数`：

*   h\_0 = 1
    
    > h\_0实际表示含义是`空单词`，这里我们是`定义`h\_0 = 1以便符合h\_2的递推关系。
    
*   h\_1 = 3
    
*   h\_2 = 2 \\times h\_1 + 2 \\times h\_{0}
    
*   ...
    
*   h\_n = 2 \\times h\_{n-1} + 2 \\times h\_{n-2} \\quad(n \\ge 2)
    

根据`初始值`h\_0 = 1, h\_1 = 3求出`递推关系的解`

h\_n = \\frac{2 + \\sqrt{3}}{2\\sqrt{3}}(1+\\sqrt{3})^n + \\frac{-2+\\sqrt{3}}{2\\sqrt{3}}(1-\\sqrt{3})^n \\quad(n \\ge 0)

> Method 2: Generating functions

###### Example 4

确定下面`数列` 的`生成函数`：0,1,4,\\cdots,n^2,\\cdots

* * *

###### Example 5

使用`生成函数`求解`递归关系`。

h\_n = 5h\_{n-1} - 6h\_{n-2} \\quad(n \\ge 2), h\_0 = 1, h\_1 = 2

* * *

###### Example 6

当`特征方程`存在`重根`时，必须`寻找与该根相关的其他解法`。

###### Example 7

求解y'' - 4y' + 4y = 0

* * *

###### Example 8

求解h\_n - 4h\_{n-1} + 4h\_{n-2} = 0 \\quad(n \\ge 2)

* * *

###### Example 9

求解h\_n = -h\_{n-1} + 3h\_{n-2} + 5h\_{n-3} + 2h\_{n-4} \\quad(n \\ge 4)

* * *

#### Solve Linear In-homogeneous Recursive Relations

##### Example

###### Example 1: Hanoi Problem

*   有`三根柱子`，在`其中一根柱子`上`穿有大小递增的n个圆盘`，最大的圆盘放在底部。

现在，要`一次一个`地将`这些圆盘`移动到`另一根柱子`上，而且规定任何时刻都`不允许将大圆盘放在小圆片的上面`。

求：将圆盘从一根柱子转移到另一根柱子所需的`移动次数`

* * *

设h\_n是将`n个圆盘从一根柱子移动到另一根柱子所需的移动次数`。

h\_n = h\_{n-1} + 1 + h\_{n+1} = 2h\_{n-1} + 1,\\quad (n \\ge 1)

> 假如说，我们有3根柱子，初始时第1根和第3根柱子都不放圆盘，第2根柱子放n个圆盘。
> 
> 如果要将这n个圆盘移动到其他圆盘上（就比如说移动到第3个柱子）。
> 
> 则，我们首选，要将`最上面的n-1个圆盘`移动到`第1个柱子`，然后把`第2根柱子底下最大的那个圆盘`移动到`第3根柱子`。
> 
> 之后，再`从第一根柱子把n-1个圆盘`移动到`第3根柱子`
> 
> > 这个子问题分解有一个好处是，可以`简单地忽略掉` `比问题规模里所有圆盘都更大的圆盘`，而这并不会`改变问题的性质`。
> > 
> > 所以我们可以从`问题规模n`中分解`子问题规模n-1`，但却仍然`保持原问题的性质`

同时，易得h\_0 = 0

* * *

*   求解h\_n = 2h\_{n-1} + 1,\\quad (n\\ge1), h\_0 = 0

* * *

> `Brahma/Reve Problem`指的是存在4根柱子的汉诺塔问题，这些问题尚未被解决。

* * *

###### Example 2

> *   Background
>     

求解h\_n = 3h\_{n-1} - 4n \\quad(n \\ge 1), h\_0 = 2

* * *

> Method 1: Differential Equation Method

> 首先，这是一个`非齐次线性微分方程`，因为b\_n = -4n \\ne 0
> 
> 所以，`非通 = 齐通 + 非特`

*   齐次线性微分方程的通解

齐次线性微分方程的通解非齐次线性微分方程的特解非齐次线性微分方程的通解

> *   求解`非齐次线性微分方程`的策略
> 
> 1.  求`齐次线性微分方程的通解`：难点在于求解`特征方法`
>     
> 2.  求`非齐次线性微分方程的特解`：难点在于`如何尝试特定类型的特殊解`
>     
>     > *   若b\_n是`n的k次多项式`，则寻找也是`n的k次多项式`的特殊解
>     >     
>     >     *   b\_n = d(constant) \\implies h\_n = r
>     >     *   b\_n = dn + e \\implies h\_n = rn + s
>     >     *   b\_n = dn^2 + en + f \\implies h\_n = rn^2 + sn + t
>     > *   若b\_n是`指数形式`，则寻找也是`指数形式`的特殊解
>     >     
>     >     *   b\_n = d^n \\implies h\_n = pd^n
>     
> 3.  将`通解`和`特解`做线性组合，并确定其中的`常数`
>     

* * *

> Method 2: Generating Function Method

> 利用`生成函数法`可以避免`微分方程法`中的`求解非齐次线性微分方程的特解`问题。

###### Example 3

求解h\_n = 2h\_{n-1} + 3^n \\quad(n \\ge 1), h\_0 = 2

* * *

齐次方程的通解非齐次方程的特解非齐次方程的通解

* * *