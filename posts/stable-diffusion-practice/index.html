<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>[SD] Stable-Diffusion Practice | SakuraWald</title><meta name="author" content="SakuraWald"><meta name="copyright" content="SakuraWald"><meta name="format-detection" content="telephone=no"><meta name="theme-color"><link rel="canonical" href="https://sakurawald.github.io/posts/stable-diffusion-practice/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-5C7FQ1MX7K"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5C7FQ1MX7K');</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: SakuraWald","link":"Link: ","source":"Source: SakuraWald","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'mediumZoom',
  islazyload: true,
  isAnchor: true,
  percent: {
    toc: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '[SD] Stable-Diffusion Practice',
  isPost: true,
  isHome: false,
  isToc: true,
  postUpdate: '2023-02-23 10:33:43'
}</script><noscript><style type="text/css">
  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = url => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      link.onload = () => resolve()
      link.onerror = () => reject()
      document.head.appendChild(link)
    })
  
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="SakuraWald" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="SakuraWald" type="application/rss+xml">
</head><body><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div class="post" id="body-wrap"><main class="layout" id="content-inner"><div id="post"><article class="github-markdown-body post-content" id="article-container"><h1 id="Stable-Diffusion-Practice"><a href="#Stable-Diffusion-Practice" class="headerlink" title="Stable-Diffusion Practice"></a>Stable-Diffusion Practice</h1><h2 id="Setup"><a href="#Setup" class="headerlink" title="Setup"></a>Setup</h2><blockquote>
<p>If you just want to use <code>stable-diffusion</code> <strong>online</strong>, you can try apps like: <a target="_blank" rel="noopener" href="https://huggingface.co/spaces/stabilityai/stable-diffusion">https://huggingface.co/spaces/stabilityai/stable-diffusion</a></p>
<p>However, we highly recommend you setup <code>stable-diffusion</code> locally for higher customizability.</p>
</blockquote>
<h3 id="Platform"><a href="#Platform" class="headerlink" title="Platform"></a>Platform</h3><h4 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h4><p><code>stable-diffusion webui</code> is a browser interface for <code>stable-diffusion</code>.</p>
<p>Firstly, use the following commands to install it.</p>
<pre><code class="lang-shell">git clone git@github.com:AUTOMATIC1111/stable-diffusion-webui.git
cd stable-diffusion-webui
bash webui.sh
</code></pre>
<h4 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h4><h5 id="Optimise-video-memory-usage"><a href="#Optimise-video-memory-usage" class="headerlink" title="Optimise video memory-usage"></a>Optimise video memory-usage</h5><pre><code class="lang-shell"># webui-user.sh
export COMMANDLINE_ARGS=&quot;--xformers&quot;
</code></pre>
<p>For some GPUs with a high cuda version. (cuda &gt; 11.8), you should <strong>manually</strong> install the <strong>required python dependencies</strong></p>
<pre><code class="lang-shell">NVIDIA GeForce RTX 3080 Ti with CUDA capability sm_86 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_37 sm_50 sm_60 sm_70.
If you want to use the NVIDIA GeForce RTX 3080 Ti GPU with PyTorch, please check the instructions at Start Locally | PyTorch 31
</code></pre>
<p>See: <a target="_blank" rel="noopener" href="https://pytorch.org/get-started/locally/">https://pytorch.org/get-started/locally/</a></p>
<h5 id="Solve-the-problem-of-generating-a-black-image-empty-image"><a href="#Solve-the-problem-of-generating-a-black-image-empty-image" class="headerlink" title="Solve the problem of generating a black-image/empty-image"></a>Solve the problem of generating a black-image/empty-image</h5><pre><code class="lang-shell"># webui-user.sh
export COMMANDLINE_ARGS=&quot;--no-half-vae --disable-nan-check&quot;
</code></pre>
<h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><h4 id="Installation-1"><a href="#Installation-1" class="headerlink" title="Installation"></a>Installation</h4><p>You can download the models from this link: <a target="_blank" rel="noopener" href="https://rentry.org/sdmodels">https://rentry.org/sdmodels</a></p>
<blockquote>
<p>Q: Should we pay for the latest <code>NovelAI</code> now ?</p>
<p>A: Maybe not, just wait for it to leak.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/TSL9TF0.png" alt="image-20230208150000465"></p>
</blockquote>
<h4 id="Configuration-1"><a href="#Configuration-1" class="headerlink" title="Configuration"></a>Configuration</h4><p>The <code>stable-diffusion model</code> (sd-model) contains all the data needed to <code>generate an image</code>.</p>
<p>Beyond that, <code>a specific model</code> might also come with the <code>pre-configuration file</code> , <code>vae.pt file</code> and <code>hyper-network file</code>, which can be used to <code>modify and enhance the style of the final generated image</code></p>
<p>For example, the architecture may be like: </p>
<pre><code class="lang-shell">stable-diffusion-webui/
├─ models/
│  ├─ Stable-diffusion/
│  │  ├─ model_name.ckpt
│  │  ├─ model_name.yaml
│  ├─ VAE/
│  │  ├─ model_name.vae.pt
│  ├─ hypernetworks/
│  │  ├─ anime.pt
│  │  ├─ furry.pt
│  │  ├─ pony.pt
</code></pre>
<h2 id="Use-case"><a href="#Use-case" class="headerlink" title="Use-case"></a>Use-case</h2><h3 id="Control-the-weight-of-prompts"><a href="#Control-the-weight-of-prompts" class="headerlink" title="Control the weight of prompts"></a>Control the weight of prompts</h3><p>Use <code>(token)</code> to strength the weight.</p>
<blockquote>
<p>For Novel-AI, use <code>&#123;token&#125;</code> instead.</p>
<p><code>stable-diffusion webui</code> ‘s coefficient differs from <code>novel-ai</code></p>
</blockquote>
<p>Use <code>[token]</code> to reduce the weight.</p>
<h3 id="The-magic-spell-to-control-the-quality-of-generated-image"><a href="#The-magic-spell-to-control-the-quality-of-generated-image" class="headerlink" title="The magic-spell to control the quality of generated-image"></a>The magic-spell to control the quality of generated-image</h3><p>There are some <code>common prompts</code> called <code>magic-spell</code> which can be used to control the <code>quality</code> , <code>style</code> , <code>category</code> and <code>color</code>  of the image.</p>
<p>For examples:</p>
<h4 id="Positive-Prompts"><a href="#Positive-Prompts" class="headerlink" title="Positive Prompts"></a>Positive Prompts</h4><pre><code>(masterpiece), (best quality), (masterpiece),(best quality),(official art),(extremely detailed CG unity 8k wallpaper),
</code></pre><pre><code>(extremely detailed CG unity 8k wallpaper), (official concept art), (outline), (ultra-detailed), (lightfast), (highly detailed reflection), (best shadow),(schematic), (anime coloring)
</code></pre><blockquote>
<p>These websites provide prompt examples:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://openart.ai/presets">https://openart.ai/presets</a></li>
<li><a target="_blank" rel="noopener" href="https://prompthero.com/">https://prompthero.com/</a></li>
<li><a target="_blank" rel="noopener" href="https://stablediffusionweb.com/prompts">https://stablediffusionweb.com/prompts</a></li>
</ol>
</blockquote>
<h4 id="Negative-Prompts"><a href="#Negative-Prompts" class="headerlink" title="Negative Prompts"></a>Negative Prompts</h4><p><code>negative prompt</code> is <strong>essential</strong> to get rid of <code>bad products</code></p>
<pre><code>lowres, bad anatomy, bad hands, text, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, from behind,from side,normal quality, jpeg artifacts, watermark, username, Missing limbs,three arms, bad feet,text font ui,malformed hands,long neck,long body,limb,bad anatomy disfigured malformed mutated,large head,(mutated hands and fingers :1.5).(long body :1.3),(mutation ,poorly drawn :1.2), disfigured, malformed, mutated,multiple breasts,three legs,
</code></pre><pre><code>(((deformed))), blurry, bad anatomy, disfigured, poorly drawn face, mutation, mutated, (extra_limb), (ugly), (poorly drawn hands), fused fingers, messy drawing, broken legs censor, censored, censor_bar, multiple breasts, (mutated hands and fingers:1.5), (long body :1.3), (mutation, poorly drawn :1.2), black-white, bad anatomy, liquid body, liquidtongue, disfigured, malformed, mutated, anatomical nonsense, text font ui, error, malformed hands, long neck, blurred, lowers, low res, bad anatomy, bad proportions, bad shadow, uncoordinated body, unnatural body, fused breasts, bad breasts, huge breasts, poorly drawn breasts, extra breasts, liquid breasts, heavy breasts, missingbreasts, huge haunch, huge thighs, huge calf, bad hands, fused hand, missing hand, disappearing arms, disappearing thigh, disappearing calf, disappearing legs, fusedears, bad ears, poorly drawn ears, extra ears, liquid ears, heavy ears, missing ears, fused animal ears, bad animal ears, poorly drawn animal ears, extra animal ears, liquidanimal ears, heavy animal ears, missing animal ears, text, ui, error, missing fingers, missing limb, fused fingers, one hand with more than 5 fingers, one hand with less than5 fingers, one hand with more than 5 digit, one hand with less than 5 digit, extra digit, fewer digits, fused digit, missing digit, bad digit, liquid digit, colorful tongue, blacktongue, cropped, watermark, username, blurry, JPEG artifacts, signature, 3D, 3D game, 3D game scene, 3D character, malformed feet, extra feet, bad feet, poorly drawnfeet, fused feet, missing feet, extra shoes, bad shoes, fused shoes, more than two shoes, poorly drawn shoes, bad gloves, poorly drawn gloves, fused gloves, bad cum, poorly drawn cum, fused cum, bad hairs, poorly drawn hairs, fused hairs, big muscles, ugly, bad face, fused face, poorly drawn face, cloned face, big face, long face, badeyes, fused eyes poorly drawn eyes, extra eyes, malformed limbs, more than 2 nipples, missing nipples, different nipples, fused nipples, bad nipples, poorly drawnnipples, black nipples, colorful nipples, gross proportions. short arm, (((missing arms))), missing thighs, missing calf, missing legs, mutation, duplicate, morbid, mutilated, poorly drawn hands, more than 1 left hand, more than 1 right hand, deformed, (blurry), disfigured, missing legs, extra arms, extra thighs, more than 2 thighs, extra calf,fused calf, extra legs, bad knee, extra knee, more than 2 legs, bad tails, bad mouth, fused mouth, poorly drawn mouth, bad tongue, tongue within mouth, too longtongue, black tongue, big mouth, cracked mouth, bad mouth, dirty face, dirty teeth, dirty pantie, fused pantie, poorly drawn pantie, fused cloth, poorly drawn cloth, badpantie, yellow teeth, thick lips, bad camel toe, colorful camel toe, bad asshole, poorly drawn asshole, fused asshole, missing asshole, bad anus, bad pussy, bad crotch, badcrotch seam, fused anus, fused pussy, fused anus, fused crotch, poorly drawn crotch, fused seam, poorly drawn anus, poorly drawn pussy, poorly drawn crotch, poorlydrawn crotch seam, bad thigh gap, missing thigh gap, fused thigh gap, liquid thigh gap, poorly drawn thigh gap, poorly drawn anus, bad collarbone, fused collarbone, missing collarbone, liquid collarbone, strong girl, obesity, worst quality, low quality, normal quality, liquid tentacles, bad tentacles, poorly drawn tentacles, split tentacles, fused tentacles, missing clit, bad clit, fused clit, colorful clit, black clit, liquid clit, QR code, bar code, censored, safety panties, safety knickers, beard, furry, pony, pubic hair, mosaic, futa, testis, (((deformed))), blurry, bad anatomy, disfigured, poorly drawn face, mutation, mutated, (extra_limb), (ugly), (poorly drawn hands), fused fingers, messy drawing, broken legs censor, censored, censor_bar, multiple breasts, (mutated hands and fingers:1.5), (long body :1.3), (mutation, poorly drawn :1.2), black-white, bad anatomy, liquid body, liquidtongue, disfigured, malformed, mutated, anatomical nonsense, text font ui, error, malformed hands, long neck, blurred, lowers, low res, bad anatomy, bad proportions, bad shadow, uncoordinated body, unnatural body, fused breasts, bad breasts, huge breasts, poorly drawn breasts, extra breasts, liquid breasts, heavy breasts, missingbreasts, huge haunch, huge thighs, huge calf, bad hands, fused hand, missing hand, disappearing arms, disappearing thigh, disappearing calf, disappearing legs, fusedears, bad ears, poorly drawn ears, extra ears, liquid ears, heavy ears, missing ears, fused animal ears, bad animal ears, poorly drawn animal ears, extra animal ears, liquidanimal ears, heavy animal ears, missing animal ears, text, ui, error, missing fingers, missing limb, fused fingers, one hand with more than 5 fingers, one hand with less than5 fingers, one hand with more than 5 digit, one hand with less than 5 digit, extra digit, fewer digits, fused digit, missing digit, bad digit, liquid digit, colorful tongue, blacktongue, cropped, watermark, username, blurry, JPEG artifacts, signature, 3D, 3D game, 3D game scene, 3D character, malformed feet, extra feet, bad feet, poorly drawnfeet, fused feet, missing feet, extra shoes, bad shoes, fused shoes, more than two shoes, poorly drawn shoes, bad gloves, poorly drawn gloves, fused gloves, bad cum, poorly drawn cum, fused cum, bad hairs, poorly drawn hairs, fused hairs, big muscles, ugly, bad face, fused face, poorly drawn face, cloned face, big face, long face, badeyes, fused eyes poorly drawn eyes, extra eyes, malformed limbs, more than 2 nipples, missing nipples, different nipples, fused nipples, bad nipples, poorly drawnnipples, black nipples, colorful nipples, gross proportions. short arm, (((missing arms))), missing thighs, missing calf, missing legs, mutation, duplicate, morbid, mutilated, poorly drawn hands, more than 1 left hand, more than 1 right hand, deformed, (blurry), disfigured, missing legs, extra arms, extra thighs, more than 2 thighs, extra calf,fused calf, extra legs, bad knee, extra knee, more than 2 legs, bad tails, bad mouth, fused mouth, poorly drawn mouth, bad tongue, tongue within mouth, too longtongue, black tongue, big mouth, cracked mouth, bad mouth, dirty face, dirty teeth, dirty pantie, fused pantie, poorly drawn pantie, fused cloth, poorly drawn cloth, badpantie, yellow teeth, thick lips, bad camel toe, colorful camel toe, bad asshole, poorly drawn asshole, fused asshole, missing asshole, bad anus, bad pussy, bad crotch, badcrotch seam, fused anus, fused pussy, fused anus, fused crotch, poorly drawn crotch, fused seam, poorly drawn anus, poorly drawn pussy, poorly drawn crotch, poorlydrawn crotch seam, bad thigh gap, missing thigh gap, fused thigh gap, liquid thigh gap, poorly drawn thigh gap, poorly drawn anus, bad collarbone, fused collarbone, missing collarbone, liquid collarbone, strong girl, obesity, worst quality, low quality, normal quality, liquid tentacles, bad tentacles, poorly drawn tentacles, split tentacles, fused tentacles, missing clit, bad clit, fused clit, colorful clit, black clit, liquid clit, QR code, bar code, censored, safety panties, safety knickers, beard, furry, pony, pubic hair, mosaic, futa, testis
</code></pre><h3 id="Text-to-image"><a href="#Text-to-image" class="headerlink" title="Text-to-image"></a>Text-to-image</h3><p>You can use some ready-made prompts to get started <strong>or</strong> write your prompt from scratch.</p>
<blockquote>
<p>Prompt-auxiliary: </p>
<ol>
<li><a target="_blank" rel="noopener" href="https://huggingface.co/spaces/Gustavosta/MagicPrompt-Stable-Diffusion">https://huggingface.co/spaces/Gustavosta/MagicPrompt-Stable-Diffusion</a></li>
<li><a target="_blank" rel="noopener" href="https://wolfchen.top/tag/">https://wolfchen.top/tag/</a></li>
</ol>
</blockquote>
<p>Some recommended params:</p>
<ul>
<li>Sample method: <code>Euler a</code> or <code>DDIM</code></li>
<li>Sample steps: about 30 ~ 40 is good</li>
<li>Width &amp; Height: you can use a small resolution for testing, and then generate a high-resolution image by <code>Hires. fix</code>. (Power of 2 preferred)</li>
<li>CFG Scale: about 5~7 is good, </li>
<li>VAE: select <code>auto</code> and keep the same <code>model_name</code> between <code>model_name.ckpt</code> and <code>model_name.vae.pt</code></li>
<li>hypernetworks: simply add this <code>token</code> into your <code>prompt</code>:  <code>&lt;hypernet:anime:1&gt;</code></li>
<li>skip-clip: default 1, set to <code>2</code> if you are using <code>novel-diffusion</code></li>
</ul>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><h5 id="Case-1"><a href="#Case-1" class="headerlink" title="Case 1"></a>Case 1</h5><pre><code>(extremely detailed CG unity 8k wallpaper), (official concept art), (outline), (ultra-detailed), (lightfast), (highly detailed reflection), (best shadow),(schematic), (anime coloring), 1girl, animal_ears, bell, bracelet, choker, collar, fox_mask, fox_tail, fur_trim, gradient, gradient_background, grey_background, hair_bell, japanese_clothes, jingle_bell, kimono, mask, mask_on_head, mask_removed, multiple_tails, neck_bell, red_eyes, short_hair, solo, tail, tail_bell, tail_ornament, white_hair, wide_sleeves
</code></pre><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/Q283LSb.jpg" alt="image-20230208150646685"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/lijzFhH.jpg" alt="image-20230208150706389"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/x9rov6R.png" alt="image-20230208150714475"></p>
<h5 id="Case-2"><a href="#Case-2" class="headerlink" title="Case 2"></a>Case 2</h5><pre><code>1girl, :d, animal_ears, architecture, bangs, blue_hair, blush, breasts, building, east_asian_architecture, eyebrows_visible_through_hair, fox_mask, hakama, hakama_skirt, holding, japanese_clothes, kimono, long_hair, long_sleeves, looking_at_viewer, mask, mask_on_head, miko, open_mouth, outdoors, purple_eyes, ribbon-trimmed_sleeves, ribbon_trim, sash, smile, solo, white_kimono, wide_sleeves
</code></pre><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/vw69NCp.png" alt="img"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/nYSG36u.png" alt="image-20230208153950160"></p>
<h3 id="Image-to-image"><a href="#Image-to-image" class="headerlink" title="Image-to-image"></a>Image-to-image</h3><p>If you want to draw another-image based on original-image, you can use <code>image-to-image</code></p>
<p><code>tag reverse</code> can help you to analyze the tags from the original-image:</p>
<blockquote>
<p>See: <a target="_blank" rel="noopener" href="https://gigazine.net/gsc_news/en/20221012-automatic1111-stable-diffusion-webui-deep-danbooru/">https://gigazine.net/gsc_news/en/20221012-automatic1111-stable-diffusion-webui-deep-danbooru/</a></p>
</blockquote>
<pre><code class="lang-shell"># webui-user.sh
export COMMANDLINE_ARGS=&quot;--deepdanbooru&quot;
</code></pre>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><h5 id="Case-1-1"><a href="#Case-1-1" class="headerlink" title="Case 1"></a>Case 1</h5><p><strong>parameters</strong></p>
<pre><code>(extremely detailed CG unity 8k wallpaper), (official concept art), (outline), (ultra-detailed), (lightfast), (highly detailed reflection), (best shadow),(schematic), (anime coloring), aerial_fireworks, architecture, bow, building, city_lights, cloud, constellation, east_asian_architecture, festival, fire, fireworks, fish, full_moon, galaxy, goldfish, jack-o&#39;-lantern, japanese_clothes, kimono, lantern, long_hair, milky_way, moon, multiple_girls, night, night_sky, paper_lantern, scenery, shooting_star, sitting, sky, smile, snow, snowing, space, star_\(sky\), starry_sky, starry_sky_print, summer_festival, tanabata, tanzaku, telescope, town, yukata
Negative prompt: (((deformed))), blurry, bad anatomy, disfigured, poorly drawn face, mutation, mutated, (extra_limb), (ugly), (poorly drawn hands), fused fingers, messy drawing, broken legs censor, censored, censor_bar, multiple breasts, (mutated hands and fingers:1.5), (long body :1.3), (mutation, poorly drawn :1.2), black-white, bad anatomy, liquid body, liquidtongue, disfigured, malformed, mutated, anatomical nonsense, text font ui, error, malformed hands, long neck, blurred, lowers, low res, bad anatomy, bad proportions, bad shadow, uncoordinated body, unnatural body, fused breasts, bad breasts, huge breasts, poorly drawn breasts, extra breasts, liquid breasts, heavy breasts, missingbreasts, huge haunch, huge thighs, huge calf, bad hands, fused hand, missing hand, disappearing arms, disappearing thigh, disappearing calf, disappearing legs, fusedears, bad ears, poorly drawn ears, extra ears, liquid ears, heavy ears, missing ears, fused animal ears, bad animal ears, poorly drawn animal ears, extra animal ears, liquidanimal ears, heavy animal ears, missing animal ears, text, ui, error, missing fingers, missing limb, fused fingers, one hand with more than 5 fingers, one hand with less than5 fingers, one hand with more than 5 digit, one hand with less than 5 digit, extra digit, fewer digits, fused digit, missing digit, bad digit, liquid digit, colorful tongue, blacktongue, cropped, watermark, username, blurry, JPEG artifacts, signature, 3D, 3D game, 3D game scene, 3D character, malformed feet, extra feet, bad feet, poorly drawnfeet, fused feet, missing feet, extra shoes, bad shoes, fused shoes, more than two shoes, poorly drawn shoes, bad gloves, poorly drawn gloves, fused gloves, bad cum, poorly drawn cum, fused cum, bad hairs, poorly drawn hairs, fused hairs, big muscles, ugly, bad face, fused face, poorly drawn face, cloned face, big face, long face, badeyes, fused eyes poorly drawn eyes, extra eyes, malformed limbs, more than 2 nipples, missing nipples, different nipples, fused nipples, bad nipples, poorly drawnnipples, black nipples, colorful nipples, gross proportions. short arm, (((missing arms))), missing thighs, missing calf, missing legs, mutation, duplicate, morbid, mutilated, poorly drawn hands, more than 1 left hand, more than 1 right hand, deformed, (blurry), disfigured, missing legs, extra arms, extra thighs, more than 2 thighs, extra calf,fused calf, extra legs, bad knee, extra knee, more than 2 legs, bad tails, bad mouth, fused mouth, poorly drawn mouth, bad tongue, tongue within mouth, too longtongue, black tongue, big mouth, cracked mouth, bad mouth, dirty face, dirty teeth, dirty pantie, fused pantie, poorly drawn pantie, fused cloth, poorly drawn cloth, badpantie, yellow teeth, thick lips, bad camel toe, colorful camel toe, bad asshole, poorly drawn asshole, fused asshole, missing asshole, bad anus, bad pussy, bad crotch, badcrotch seam, fused anus, fused pussy, fused anus, fused crotch, poorly drawn crotch, fused seam, poorly drawn anus, poorly drawn pussy, poorly drawn crotch, poorlydrawn crotch seam, bad thigh gap, missing thigh gap, fused thigh gap, liquid thigh gap, poorly drawn thigh gap, poorly drawn anus, bad collarbone, fused collarbone, missing collarbone, liquid collarbone, strong girl, obesity, worst quality, low quality, normal quality, liquid tentacles, bad tentacles, poorly drawn tentacles, split tentacles, fused tentacles, missing clit, bad clit, fused clit, colorful clit, black clit, liquid clit, QR code, bar code, censored, safety panties, safety knickers, beard, furry, pony, pubic hair, mosaic, futa, testis, (((deformed))), blurry, bad anatomy, disfigured, poorly drawn face, mutation, mutated, (extra_limb), (ugly), (poorly drawn hands), fused fingers, messy drawing, broken legs censor, censored, censor_bar, multiple breasts, (mutated hands and fingers:1.5), (long body :1.3), (mutation, poorly drawn :1.2), black-white, bad anatomy, liquid body, liquidtongue, disfigured, malformed, mutated, anatomical nonsense, text font ui, error, malformed hands, long neck, blurred, lowers, low res, bad anatomy, bad proportions, bad shadow, uncoordinated body, unnatural body, fused breasts, bad breasts, huge breasts, poorly drawn breasts, extra breasts, liquid breasts, heavy breasts, missingbreasts, huge haunch, huge thighs, huge calf, bad hands, fused hand, missing hand, disappearing arms, disappearing thigh, disappearing calf, disappearing legs, fusedears, bad ears, poorly drawn ears, extra ears, liquid ears, heavy ears, missing ears, fused animal ears, bad animal ears, poorly drawn animal ears, extra animal ears, liquidanimal ears, heavy animal ears, missing animal ears, text, ui, error, missing fingers, missing limb, fused fingers, one hand with more than 5 fingers, one hand with less than5 fingers, one hand with more than 5 digit, one hand with less than 5 digit, extra digit, fewer digits, fused digit, missing digit, bad digit, liquid digit, colorful tongue, blacktongue, cropped, watermark, username, blurry, JPEG artifacts, signature, 3D, 3D game, 3D game scene, 3D character, malformed feet, extra feet, bad feet, poorly drawnfeet, fused feet, missing feet, extra shoes, bad shoes, fused shoes, more than two shoes, poorly drawn shoes, bad gloves, poorly drawn gloves, fused gloves, bad cum, poorly drawn cum, fused cum, bad hairs, poorly drawn hairs, fused hairs, big muscles, ugly, bad face, fused face, poorly drawn face, cloned face, big face, long face, badeyes, fused eyes poorly drawn eyes, extra eyes, malformed limbs, more than 2 nipples, missing nipples, different nipples, fused nipples, bad nipples, poorly drawnnipples, black nipples, colorful nipples, gross proportions. short arm, (((missing arms))), missing thighs, missing calf, missing legs, mutation, duplicate, morbid, mutilated, poorly drawn hands, more than 1 left hand, more than 1 right hand, deformed, (blurry), disfigured, missing legs, extra arms, extra thighs, more than 2 thighs, extra calf,fused calf, extra legs, bad knee, extra knee, more than 2 legs, bad tails, bad mouth, fused mouth, poorly drawn mouth, bad tongue, tongue within mouth, too longtongue, black tongue, big mouth, cracked mouth, bad mouth, dirty face, dirty teeth, dirty pantie, fused pantie, poorly drawn pantie, fused cloth, poorly drawn cloth, badpantie, yellow teeth, thick lips, bad camel toe, colorful camel toe, bad asshole, poorly drawn asshole, fused asshole, missing asshole, bad anus, bad pussy, bad crotch, badcrotch seam, fused anus, fused pussy, fused anus, fused crotch, poorly drawn crotch, fused seam, poorly drawn anus, poorly drawn pussy, poorly drawn crotch, poorlydrawn crotch seam, bad thigh gap, missing thigh gap, fused thigh gap, liquid thigh gap, poorly drawn thigh gap, poorly drawn anus, bad collarbone, fused collarbone, missing collarbone, liquid collarbone, strong girl, obesity, worst quality, low quality, normal quality, liquid tentacles, bad tentacles, poorly drawn tentacles, split tentacles, fused tentacles, missing clit, bad clit, fused clit, colorful clit, black clit, liquid clit, QR code, bar code, censored, safety panties, safety knickers, beard, furry, pony, pubic hair, mosaic, futa, testis
Steps: 40, Sampler: Euler a, CFG scale: 6, Seed: [?], Size: 1024x702, Model hash: 8712e20a5d, Model: [anything-diffusion] Anything-V3.0, Denoising strength: 0.75, Mask blur: 4
</code></pre><p><strong>original-image</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/9y5jBfQ.png" alt="original-image"></p>
<p><strong>generated-image</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/tXKbX94.jpg" alt="image-20230208154144700"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.imgur.com/BZUntu6.jpg" alt="image-20230208144901544"></p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ol>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_53065229/article/details/127814292">https://blog.csdn.net/weixin_53065229/article/details/127814292</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv19113199?from=articleDetail">https://www.bilibili.com/read/cv19113199?from=articleDetail</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv19060316?from=search">https://www.bilibili.com/read/cv19060316?from=search</a></li>
<li><a target="_blank" rel="noopener" href="https://gigazine.net/gsc_news/en/20221012-automatic1111-stable-diffusion-webui-deep-danbooru/">https://gigazine.net/gsc_news/en/20221012-automatic1111-stable-diffusion-webui-deep-danbooru/</a></li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://sakurawald.github.io">SakuraWald</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://sakurawald.github.io/posts/stable-diffusion-practice/">https://sakurawald.github.io/posts/stable-diffusion-practice/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/practice/">practice</a><a class="post-meta__tags" href="/tags/ai/">ai</a><a class="post-meta__tags" href="/tags/gpt/">gpt</a><a class="post-meta__tags" href="/tags/diffusion/">diffusion</a><a class="post-meta__tags" href="/tags/art/">art</a><a class="post-meta__tags" href="/tags/cg/">cg</a><a class="post-meta__tags" href="/tags/novel-ai/">novel_ai</a><a class="post-meta__tags" href="/tags/cuda/">cuda</a><a class="post-meta__tags" href="/tags/nvidia/">nvidia</a><a class="post-meta__tags" href="/tags/python/">python</a><a class="post-meta__tags" href="/tags/computation/">computation</a><a class="post-meta__tags" href="/tags/anime/">anime</a><a class="post-meta__tags" href="/tags/draw/">draw</a></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://avatars.githubusercontent.com/u/10484271?v=4" alt="avatar"/></div><div class="author-info__name">SakuraWald</div><div class="author-info__description">dig description.sakurawald.com txt</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">41</div></a></div><div><a id="card-friends-btn" href="/friends/"><i class="fa fa-user"></i><span>Friends</span></a><a id="card-search-btn" href="#"><i class="fa fa-search"></i><span>Search</span></a></div><a id="card-info-btn" href="https://github.com/SakuraWald" target="_blank"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Stable-Diffusion-Practice"><span class="toc-number">1.</span> <span class="toc-text">Stable-Diffusion Practice</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup"><span class="toc-number">1.1.</span> <span class="toc-text">Setup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Platform"><span class="toc-number">1.1.1.</span> <span class="toc-text">Platform</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Installation"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">Installation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Configuration"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Optimise-video-memory-usage"><span class="toc-number">1.1.1.2.1.</span> <span class="toc-text">Optimise video memory-usage</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Solve-the-problem-of-generating-a-black-image-empty-image"><span class="toc-number">1.1.1.2.2.</span> <span class="toc-text">Solve the problem of generating a black-image&#x2F;empty-image</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Model"><span class="toc-number">1.1.2.</span> <span class="toc-text">Model</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Installation-1"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">Installation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Configuration-1"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">Configuration</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Use-case"><span class="toc-number">1.2.</span> <span class="toc-text">Use-case</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Control-the-weight-of-prompts"><span class="toc-number">1.2.1.</span> <span class="toc-text">Control the weight of prompts</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-magic-spell-to-control-the-quality-of-generated-image"><span class="toc-number">1.2.2.</span> <span class="toc-text">The magic-spell to control the quality of generated-image</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Positive-Prompts"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">Positive Prompts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Negative-Prompts"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">Negative Prompts</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Text-to-image"><span class="toc-number">1.2.3.</span> <span class="toc-text">Text-to-image</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Example"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">Example</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Case-1"><span class="toc-number">1.2.3.1.1.</span> <span class="toc-text">Case 1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Case-2"><span class="toc-number">1.2.3.1.2.</span> <span class="toc-text">Case 2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Image-to-image"><span class="toc-number">1.2.4.</span> <span class="toc-text">Image-to-image</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-1"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">Example</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Case-1-1"><span class="toc-number">1.2.4.1.1.</span> <span class="toc-text">Case 1</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">1.3.</span> <span class="toc-text">References</span></a></li></ol></li></ol></div></div></div></div></main></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function renderMathjax() {
  if (!window.MathJax) {
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ["\\(","\\)"]],
        tags: 'ams',
        displayMath: [
              ['$$', '$$'],
              ['\\[', '\\]']
        ],
        maxMacros: 1000,           // maximum number of macro substitutions per expression
        maxBuffer: 5 * 1024,       // maximum size for the internal TeX string (5K)
        processEscapes: true,
        formatError: (jax, err) => {
          jax.formatError(err);
          console.warN(err);
        }
      },
      chtml: {
        scale: 1.1
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
              const display = !!node.type.match(/; *mode=display/)
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
              const text = document.createTextNode('')
              node.parentNode.replaceChild(text, node)
              math.start = {node: text, delim: '', n: 0}
              math.end = {node: text, delim: '', n: 0}
              doc.math.push(math)
            }
          }, ''],
          insertScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              if (node.hasAttribute('display')) {
                btf.wrap(node, 'div', { class: 'mathjax-overflow' })
              } else {
                btf.wrap(node, 'span', { class: 'mathjax-overflow' })
              }
            });

          }, '', false]
        }
      }
    }
    
    const script = document.createElement('script')
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
    script.id = 'MathJax-script'
    script.async = true
    document.head.appendChild(script)
  } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      // If the first page you visited doesn't contain any math codes, then the second time you visit a page contains math codes, you will get "Mathjax Retry" error.
      //- MathJax.typeset()
      MathJax.typesetPromise();
  }

}
renderMathjax();</script><script>function processSvgPanZoom() {
    const $targetWrap = document.querySelectorAll('#article-container svg')
    if ($targetWrap.length) {
        window.runSvgPanZoom = () => {
            window.loadSvgPanZoom = true

            Array.from($targetWrap).forEach((item, index) => {
                var saved_viewbox = item.getAttribute("viewBox");
                var controller = svgPanZoom(item);
                item.setAttribute("viewBox", saved_viewbox);
                controller.fit();
                controller.center();
            });
        }
        const loadSvgPanZoom = () => {
            window.loadSvgPanZoom ? runSvgPanZoom() : getScript('https://cdn.jsdelivr.net/npm/svg-pan-zoom/dist/svg-pan-zoom.min.js').then(runSvgPanZoom)
        }
        window.pjax ? loadSvgPanZoom() : document.addEventListener('DOMContentLoaded', loadSvgPanZoom)
    }
}</script><script>function processMermaid() {
  const $targetWrap = document.querySelectorAll('#article-container code.lang-mermaid, #article-container code.language-mermaid');
  if ($targetWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true

      const theme = 'default'
      Array.from($targetWrap).forEach((item, index) => {
        const mermaidSrc = item
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode);
          mermaidSrc.remove();
        })
      })
      processSvgPanZoom(); 
    }
    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }
    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
}
processMermaid();</script><script>function processHighlightjs() {
  window.runHighlightjs = () => {
      window.loadHightlightjs = true

      hljs.highlightAll();
  }

  const loadHightlightjs = () => {
      if (window.loadHightlightjs) {
          runHighlightjs();
      } else {
          getCSS('/css/third-party/highlightjs-github.css');
          getScript('/js/third-party/highlight.min.js').then(runHighlightjs);
      }
  }
  window.pjax ? loadHightlightjs() : document.addEventListener('DOMContentLoaded', loadHightlightjs)
}
processHighlightjs();</script><script>function loadGiscus () {
  let nowTheme = 'light' 

  const config = Object.assign({
    src: 'https://giscus.app/client.js',
    'data-repo': 'sakurawald/sakurawald.github.io',
    'data-repo-id': 'R_kgDOItDE4Q',
    'data-category-id': 'DIC_kwDOItDE4c4CTv3v',
    'data-mapping': 'pathname',
    'data-theme': nowTheme,
    'data-reactions-enabled': '1',
    crossorigin: 'anonymous',
    async: true
  },null)

  let ele = document.createElement('script')
  for (let key in config) {
    ele.setAttribute(key, config[key])
  }
  document.getElementById('giscus-wrap').insertAdjacentElement('afterbegin',ele)
}


if ('Giscus' === 'Giscus' || !true) {
  if (true) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
  else loadGiscus()
} else {
  function loadOtherComment () {
    loadGiscus()
  }
}</script></div><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["link[rel=\"canonical\"]","meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","head > title","#config-diff","#body-wrap",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof typed === 'object' && typed.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-5C7FQ1MX7K', {'page_path': window.location.pathname});
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div></body></html>